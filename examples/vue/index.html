<script type="importmap">
  {
    "imports": {
      "vue": "https://unpkg.com/vue@3/dist/vue.esm-browser.js",
      "book-store": "./books.store.js"
    }
  }
</script>
<div id="app">
  {{ message }}
  <div
    v-for="book in state.books"
    :key="book.key"
  >
    {{ book.name }}
  </div>
  
  <button @click="increment">
    {{ state.count }}
  </button>
</div>
<script type="module">
  import { createApp, reactive } from 'vue'
  import BookFactory from 'book-store'

  createApp({
    setup() {
      const { books, loadBooks } = BookFactory()
      loadBooks()
      
      setTimeout(() => {
        books.splice(2, 3, {
          'key': 3,
          'name': 'book 3'
        })
        console.log('-------------', books)
      }, 1000)

      const state = reactive({ 
        count: 1,
        books
      })

      function increment() {
        state.count++
      }

      // expose the state to the template
      return {
        state,
        increment
      }
    }, 
    data() {
      return {
        message: 'Hello Vue aa!'
      }
    }
  }).mount('#app')
</script>
<!-- <script type="module" src="./index.js">
  /* JavaScript module code here */
  import { test } from './index'
  test.test()
</script> -->